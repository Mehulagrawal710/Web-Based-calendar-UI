<!DOCTYPE html>
<html>

<head>
	<title>Calendar</title>
	<meta charset="utf-8">
	<!--Bootstrap-->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<!--AngularJS-->
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>

<style>

body{background-image: url(https://www.plannthat.com/wp-content/uploads/2018/10/christmas-marketing-plan.jpeg);
	 background-repeat: no-repeat;x
	 background-size: 100% auto;}

.day{border: 1px solid black;
	  height: 100px;
	  width: 100px;
	  float: left;}
.today{background-color: lightgreen;}	  

.day:hover{background-color: powderblue;}	  	

.addevent{height: 80%;
		  width: 40%;
		  position: fixed;
		  top: 10%;
		  left: 30%;
		  background-color: rgba(255,255,255,1);}
	
</style>

</head>
<body ng-app="myApp" ng-controller="ctrl" class="container" style="background-color: #eee;">

	<h1 align="center">Calendar</h1>
	
	<button ng-click="decrement_year()"><<</button>
	<span>year</span>
	<button ng-click="increment_year()">>></button>
	<br><br>
	<button ng-click="decrement_month()"><<</button>
	<span>month</span>
	<button ng-click="increment_month()">>></button>
	<button ng-click="today()">today</button>
	<button ng-click="show_all_event_page()">all events</button>
	<h2>{{months[current_month].month}}, {{current_year}}</h2>
	


	<div>
		<div ng-repeat="i in get_days_array(current_month)">
			<div class="day" ng-click="add_event(i)" ng-class="{today: i==current_date && current_month==month && current_year == year}">
				<h3>{{i}}</h3>
				<h4>{{weekdays[weekday(i)]}}</h4>
			</div>
		</div>
	</div>
	

	<div class="addevent" ng-if="open_add_event==1">
		<div class="container">
			<h1>{{add_event_date}}</h1>
			<h2>Add Event</h2>
			<h3>Event Title:</h3>
			<input ng-model="event_title">
			<br>
			<h3>Event Description:</h3>
			<input ng-model="event_description">
			<button ng-click="add_this_event(event_title, event_description)">Add Event</button>
			<button ng-click="close_add_event()">close</button>
		</div>
	</div>

	<div class="addevent" ng-if="show_all_event==1">
		<div class="container">
			<div ng-repeat="event in events">
				<p>{{event.d}} {{months[event.m].month}} {{event.y}} {{event.t}} {{event.desc}}</p>
			</div>
			<button ng-click="close_all_event_page()">close</button>
		</div>
	</div>



<script>
var app = angular.module('myApp', []);
app.controller('ctrl', function ($scope) {

	date = new Date();
	$scope.current_date = date.getDate();
	$scope.current_day = date.getDay();
	$scope.month = date.getMonth();
	$scope.year = date.getFullYear();

	$scope.current_year = $scope.year;
	$scope.current_month = $scope.month;
	
	$scope.today = function(){
		$scope.current_date = date.getDate();
		$scope.current_day = date.getDay();
		$scope.month = date.getMonth();
		$scope.current_year = date.getFullYear();

		$scope.current_year = $scope.year;
		$scope.current_month = $scope.month;
	}

	

    $scope.months = [
    	{month:'january', no_of_days:31},
    	{month:'february', no_of_days:28},
    	{month:'march', no_of_days:31},
    	{month:'april', no_of_days:30},
    	{month:'may', no_of_days:31},
    	{month:'june', no_of_days:30},
    	{month:'july', no_of_days:31},
    	{month:'august', no_of_days:31},
    	{month:'september', no_of_days:30},
    	{month:'october', no_of_days:31},
    	{month:'november', no_of_days:30},
    	{month:'december', no_of_days:31}
    ];

    $scope.weekdays = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];

    $scope.events = [];

    $scope.increment_year = function(){
    	if ($scope.current_year !=3000) {
    			$scope.current_year +=1;
    	}
    }

    $scope.decrement_year = function(){
    	if ($scope.current_year !=1900) {
    			$scope.current_year -=1;
    	}	
    }

    $scope.increment_month = function(){
    	if ($scope.current_month !=11) {
    			$scope.current_month +=1;
    	}
    	else{
    		$scope.current_year +=1;
    		$scope.current_month = 0;
    	}
    }

    $scope.decrement_month = function(){
    	if ($scope.current_month !=0) {
    			$scope.current_month -=1;
    	}
    	else{
    		$scope.current_year -=1;
    		$scope.current_month = 11;
    	}	
    }

    $scope.get_days_array = function(n){
    	$scope.days_array = [];
    	for(x=1; x<=$scope.months[n].no_of_days; x++){
    		$scope.days_array.push(x);
    	}
    	return $scope.days_array;
    }
    //k is the date, m is month march is 1 and feb is 12, d is last two digits of year and one minus if it is jan or feb, c is first two digits of the year
    

    zellers_month = [11,12,1,2,3,4,5,6,7,8,9,10];

    $scope.weekday = function(i){
    	k = i;
    	m = zellers_month[$scope.current_month];
    	d = ($scope.current_year)%100;
    	c = Math.floor(($scope.current_year)/100);

    	f = k + Math.floor((13*m-1)/5) + d + Math.floor(d/4) + Math.floor(c/4) - 2*c;
    	rem = Math.floor(f%7);
    	if(rem<0){index = rem + 7;}
    	else{index = rem;}
    	return index;
    }

    $scope.open_add_event = 0;
    var event_date;
    $scope.add_event = function(date){
	    event_date = date;	
    	$scope.open_add_event = 1;
    	$scope.add_event_date = date+", "+$scope.months[$scope.current_month].month+", "+$scope.current_year;
    }
    $scope.close_add_event = function(){
    	$scope.open_add_event = 0;	
    }
    $scope.add_this_event = function(title, description){
    	$scope.events.push(
    		{
    			d: event_date,
    			m: $scope.current_month,
    			y: $scope.current_year,
    			t: title,
    			desc: description
    		}
    	);
    }

    $scope.show_all_event = 0;

    $scope.show_all_event_page = function(){
    	$scope.show_all_event = 1;
    }

    $scope.close_all_event_page = function(){
    	$scope.show_all_event = 0;
    }

});
</script>

</body>
</html>